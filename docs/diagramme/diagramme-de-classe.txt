@startuml
' ========== NOYAU MOTEUR / SCENES ==========
abstract class Scene {
}

class Game {
}

class MapScene {
}

class BattleScene {
}

' ========== MONDE, CARTES ET COLLISIONS ==========
class World {
}

class Map {
- mapWidth : int
- mapHeight : int
- tileSize : float
- mapData : std::vector<std::vector<Tile>>
- tilesetManager : TilesetManager
+ Map(int width, int height, float tilesize)
+ init() : bool
+ getTileType(int x, int y) : TileType const
+ setTileType(int x, int y, TileType type) : void
+ getTile(int tileX, int tileY) : Tile const&
+ getTile(int tileX, int tileY) : Tile&
+ getWidth() : int const
+ getHeight() : int const
+ getTileSize() : float const
+ setTileSize(float size) : void
+ setDimensions(int width, int height) : void
}

class Tile {
- positionX : int
- positionY : int
- type : TileType
- sprite : sf::Sprite
- isObstacle : bool
+ Tile()
+ Tile(int x, int y, TileType type, bool obstacle)
+ draw(sf::RenderWindow& window) : void const
+ getPositionX() : int
+ getPositionY() : int
+ getType() : TileType const
+ getIsObstacle() : bool const
+ setPositionX(int x) : void
+ setPositionY(int y) : void
+ setType(TileType type) : void
+ setIsObstacle(bool o) : void
+ setTexture(const sf::Texture& texture, const sf::IntRect& rect) : void
}

' Énumération TileType
enum TileType {
 GRASS
 PATH
 WALL
 WATER
 TREE
 ROCK
 FLOWER
 DIRT
}

class TileSetManager {
- tileset : sf::Texture
- tileSize : float
+ loadTileset(const std::string& path, float tileSize) : bool
+ getTexture() : const sf::Texture&
+ getTileRect(TileType type) : sf::IntRect
}

class TileTypeUtils <<utility>> {
+ {static} isObstacle(TileType type) : bool
+ {static} getTileColor(TileType type) : sf::Color
}

class MapRenderer {
+ render(sf::RenderWindow& window, const Map& map) : void
}

class LoadMap {
+ loadFromFile(const std::string& filepath, Map& map) : bool
}

' ========== ENTITES, JOUEUR ET PNJ ==========
class Entity {
- positionX : float
- positionY : float
- positionTileX : int
- positionTileY : int
- sprite : sf::Sprite
+ Entity()
+ Entity(float x, float y, const sf::Texture& texture)
+ {abstract} update() : void
+ {abstract} draw(sf::RenderWindow& window) : void
+ getPositionX() : float
+ getPositionY() : float
+ getPositionTileX() : int
+ getPositionTileY() : int
+ getSprite() : sf::Sprite
+ setPositionX(float x) : void
+ setPositionY(float y) : void
+ setPositionTileX(int x) : void
+ setPositionTileY(int y) : void
+ setSprite(sf::Sprite sprite) : void
}

' Énumération Direction
enum Direction {
 North
 South
 West
 East
}

class Character {
- direction : Direction
- moveSpeed : double
+ Character()
+ getDirection() : Direction
+ getMoveSpeed() : double
+ setDirection(Direction direction) : void
+ setMoveSpeed(double speed) : void
}

class Player {
- name : std::string
- party : Party*
- bag : Bag*
- isMoving : bool
- targetX : float
- targetY : float
- moveProgress : float
- currentMap : Map*
+ Player()
+ getName() : std::string
+ setName(std::string name) : void
+ getParty() : Party*
+ setParty(Party* party) : void
+ getBag() : Bag*
+ setBag(Bag* bag) : void
+ handleInput(sf::Event& event) : void
+ update() : void override
+ canMove(float newX, float newY) : bool
+ setMap(Map* map) : void
}

class NPC {
}

class Trainer {
}

' ========== POKEMON, STATISTIQUES ET ATTAQUES ==========
class Party {
- pokemons : std::vector<Pokemon*>
+ getPokemons() : std::vector<Pokemon*>
+ setPokemons(Pokemon* pokemon, int index) : void
}

class Pokemon {
+ name : Name
+ id : int
}

' Énumération Name (pour Pokemon)
enum Name {
 Bulbizarre
 Herbizarre
 Florizarre
 Salamèche
 Reptincel
 Dracaufeu
 Carapuce
 Carabaffe
 Tortank
 Chenipan
}

class PokemonSpecies {
}

class Stats {
}

class Move {
}

class TypePokemon {
}

class TypeChart {
}

' ========== SYSTEME DE COMBAT ==========
class Battle {
}

abstract class BattleAction {
}

class AttackAction {
}

class SwitchAction {
}

class UseItemAction {
}

class FleeAction {
}

class DamageCalculator {
}

' ========== OBJETS ET INVENTAIRE ==========
class Bag {
}

class Item {
}

class Pokeball {
}

class Potion {
}

class ItemStack {
}

' ========== DIALOGUE, QUETES ET SAUVEGARDE ==========
class DialogScript {
}

class Quest {
}

class SaveManager {
}

class GameState {
}

' ========== RELATIONS ==========
' Noyau moteur
Game --> Scene : currentScene
Scene <|-- MapScene
Scene <|-- BattleScene

' Monde
World "1" --> "*" Map
Map "1" --> "*" Tile : mapData
Map "1" --> "1" TilesetManager
MapRenderer ..> Map : uses
LoadMap ..> Map : loads

' Tile utilise TileType
Tile --> TileType
TileTypeUtils ..> TileType : uses

' Entités - Character hérite de Entity
Entity <|-- Character
Character --> Direction

' Player hérite de Character
Character <|-- Player
Character <|-- NPC
NPC <|-- Trainer

' Player et relations
Player "1" --> "1" Party : party
Player "1" --> "1" Bag : bag
Player "1" --> "1" Map : currentMap
Trainer "1" --> "1" Party : party

' Pokemon
Party "1" --> "*" Pokemon
Pokemon --> Name
Pokemon "*" --> "1" PokemonSpecies : baseData
Pokemon "1" --> "1" Stats
Pokemon "1" --> "4" Move : moves
Move "*" --> "1" TypePokemon

' Combat
Battle "1" --> "1" Trainer : playerTrainer
Battle "1" --> "1" Trainer : opponent
Battle "1" --> "1" Pokemon : activePlayerMon
Battle "1" --> "1" Pokemon : activeOpponentMon
Battle ..> DamageCalculator
BattleAction <|-- AttackAction
BattleAction <|-- SwitchAction
BattleAction <|-- UseItemAction
BattleAction <|-- FleeAction

' Inventaire
Bag "1" --> "*" ItemStack
ItemStack "*" --> "1" Item
Item <|-- Pokeball
Item <|-- Potion

' Dialogue et sauvegarde
NPC "1" --> "1" DialogScript
SaveManager ..> GameState

@enduml
